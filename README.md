## Часть II Базовые инструменты Django

## ГЛАВА 3 Создание и настройка проекта
Прежде чем начать писать код сайта, следует создать проект этого сайта, указать его настройки и сформировать все необходимые приложения. Всему этому будет посвящена текущая глава.

### 3.1. Подготовительные действия
- [Установить](https://www.python.org/downloads/) исполняющую среду языка `Python`
- [Установить](https://www.djangoproject.com/download/) сам фреймворк `Django`.
- Установить `СУБД`
	- `SQLite` - никаких дополнительных программ устанавливать не нужно, по­ скольку программное ядро этой СУБД поставляется непосредственно в со­ ставе исполняющей среды Python.База данных SQLite создается автоматически при первой попытке обращения к ней.
	- `MySQL` - понадобится установить клиент и, если база данных будет нахдиться на этом же компьютере, что и сайт, сервер этой СУБД.Скачать [здесь](https://dev.mysql.com/downloads/)
	- Кроме того, следует установить Руthоn-библиотеку mysqlclient, служащую коннектором (соединителем) между Python и MySQL (`pip install mysqlclient`).
	- `PostgreSQL` - понадобится установить, прежде всего, Руthоn-коннектор этой СУБД, называемый `psycorg`, который можно найти по [интернет-адресу](http://www.psycopg.org/psycopg/).Если база данных будет находиться на том же компьютере, что и сайт, нужно установить сервер.База данных формата PostgreSQL не будет создана автоматически, и ее пона­ добится создать вручную, равно как и пользователя, от имени которого Django будет подключаться к ней.
	- Также Django поддерживает работу с базами данных Oracle, Microsoft SQL Server, FireЬird, IВМ DB2, SAP SQL Anywhere и механизмом ODBC. Подробенее [здесь](https://docs.djangoproject.com/en/4.1/ref/databases/)

###  3.2. Создание проекта Django

- `django-admin startproject <имя проекта> [<путь к папке проекта>]` - нового проекта Django
	- `manage.py` - служебная уrилита, предназначенная для выполнения различных действий над проектом
	- пакет конфигурации, чье имя совпадает с именем проекта.
- Папка проекта может быть впоследствии перемещена в любое другое место файло­вой системы, а также переименована. Никакого влияния на работу проекта эти дей­ ствия не оказывают.

### 3.3. Настройки проекта

- `settings.py` - в этом файле находятся на­стройки пакета конфигурации.

### 3.3.1. Основные настройки

- `BASE_DIR` - задает путь к папке проекта. По умолчанию этот путь вычисляется автоматически;
- `DEBUG` - указывает режим работы сайта: отладочный (значение True ) или экс­ плуатационный ( False ) . В отладочном режиме, при возникновении любой ошибки в коде сайта Django выводит веб-страницу с детальным описанием этой ошибки и сведениями, позволяющими понять ее причину.
- `DEFAULT_ CНARSET` - кодировка веб-страниц по умолчанию. Значение этого пара­
метра по умолчанию: utf-8;
- `FILE_ CНARSET` - кодировка текстовых файлов, в частности, файлов шаблонов.
Значение по умолчанию: utt-8;
- `ROOT_URLCONF` - путь к модулю, в котором записаны маршруты уровня проекта, в виде строки. Значение этого параметра указывается сразу при создании про­ екта;
- `SECRET_КЕY`- секретный ключ, представляющий собой строку с произвольным набором символов. Активно используется программным ядром Django и подсис­ темой разграничения доступа для шифрования важных данных. При создании проекта ему присваивается секретный ключ, сгенерированный утилитой django-admin. Менять этот секретный ключ без особой необходимости не стоит. Также его следует хранить в тайне, в противном случае он может попасть в руки зло­ умышленникам, которые используют его для атаки на сайт.

### 3.3.2. Параметры баз данных
- `DATAВASES` - здесь записываются все базы данных, используемые проектом. Его значением должен быть словарь Python. Ключи элементов этого словаря задают псевдонимы баз данных, зарегистрированных в проекте. Можно указать произ­вольное количество баз данных.
При созда­нии проекта создается единственная база данных. База за­писывается в формате `SQLite` и хранится в файле `db.sqliteЗ`.
Параметры баз данных, поддерживаемых Django:
- `ENGINE` - формат используемой базы данных. Указывается как путь к модулю, реализующему работу с нужным форматом баз данных, в виде строки. Доступны следующие значения:
	- django.db.backends.sqliteЗ - `SQLite`;
	- django.db.backends.mysql - `MySQL`;
	- django.db.backends.postgresql - `PostgreSQL`;
	- django.db.backends.oracle - `Oracle`;
- `NАМЕ` - пуrъ к файлу базы данных, если используется SQLite, или имя базы дан­ных в случае серверных СУБД;
- `ТIМЕ_ ZONE` - временная зона для значений даты и времени, хранящихся в базе.
Следующие параметры используются только в случае серверных СУБД:
- `HOST` - интернет-адрес компьютера, на котором работает СУБД;
- `PORT` - номер ТСР-порта, через который выполняется подключение к СУБД. Значение по умолчанию - пустая строка (используется порт по умолчанию);
- `USER` - имя пользователя, от имени которого Django подключается к базе дан­ных;
- `PASSWORD` - пароль пользователя, от имени которого Django подключается к базе;
- `CONN_МАХ_АGЕ`- время, в течение которого соединение с базой данных будет открыто, в виде целого числа в секундах.Если задано значение О, соединение будет закрываться сразу после обработки запроса. Если задано значение `None`, соединение будет открыто всегда.
- `OPТIONS` - дополнительные параметры подключения к базе данных, специфич­ ные для используемой СУБД. Записываются в виде словаря, в котором каждый элемент указывает отдельный параметр. Значение по умолчанию - пустой сло­ варь.

### 3.3.3. Список зарегистрированных приложений

- `INSTALLED_ APPS` - Список приложений, зарегистрированных в проекте. Все приложения, составляющие проект - как написанные самим разработчиком сайта, так и входящие в состав Django, - должны быть приведены в этом списке, в противном случае они не будут работать.
Он содержит такие стандартные приложения:
	- `django.contrib.admin` - реализует функциональность административного веб­сайта Django
	- `django.contrib.auth` - реализует работу встроенной во фреймворк подсистемы разграничения доступа. Используется административным сайтом.
	- `django.contrib.contenttypes` - хранит список всех моделей, объявленных во всех приложениях сайта. Используется при создании полиморфных связей меж­ду моделями административным сайтом
	- `django.contrib.sessions` - обеспечивает хранение данных клиента на стороне сервера в сессиях. Требуется при задействовании сессий и исполь­зуется административным сайтом
	- `django.contrib.messages` - выводит всплывающие сообщения. Требуется для обработки всплывающих сообщений и ис­пользуется административным сайтом
	- `django.contrib.staticfiles` - реализует обработку статических файлов. Необходимо, если в составе сайта имеются статические файлы.

### 3.3.4. Список зарегистрированных посредников
- `middleware` (посредник) - это программный модуль, выполняющий пред­варительную обработку клиентского запроса перед передачей его контроллеру, а также окончательную обработку ответа, сгенерированного контроллером. Список посредников, зарегистрированных в проекте, указывается в параметре MIDDLEWARE. Все посредники, используемые приложениями проекта должны быть приведены в этом списке. В противном случае они не будут работать.
	- 'django.middleware.security.SecurityMiddleware' - реализует дополнительную защиту сайта от сетевых атак;
	- 'django.contrib.sessions.middleware.SessionMiddleware' - обеспечивает работу сессий на низком уровне. Используется подсистемами разграничения доступа, сессий и всплывающих сообщений.
	- 'django.middleware.common.CommonMiddleware' - участвует в предварительной об­ работке запросов;
	- 'django.middleware.csrf.CsrfViewMiddleware' - осуществляет защиту от межсай­товых запросов при обработке данных, переданных сайту НТТР-методом POST;
	- 'django.contrib.auth.middleware.AuthenticationMiddleware' - обавляет в объект запроса атрибут, хранящий текущего пользователя. Через этот атрибут в кон­ троллерах и шаблонах можно выяснить, какой пользователь выполнил вход на сайт и выполнил ли вообще. Используется административным сайтом и подсис­ темой разграничения доступа.
	- 'django.contrib.messages.middleware.MessageMiddleware' - обеспечивает обработ­ ку всплывающих сообщений на низком уровне. Используется административным сайтом и подсистемой всплывающих сообщений.
	- 'django.middleware.clickjacking.XFrameOptionsMiddleware' - реализует дополни­тельную защиту сайта от сетевых атак.

### 3.3.5. Языковые настройки
- `LANGUAGE_CODЕ` - код языка, на котором будут выводиться системные сообщения и страницы административного сайта. Значение по умолчанию: "en-us" (амери­канский английский). Для указания русского языка следует записать этот пара­ метр следующим образом: `LANGUAGE CODE = 'ru-ru'`
- `USE_I18N` - если `True`, будет активизирована встроенная в Django система авто­ матического перевода на язык, записанный в параметре LANGUAGE_CODЕ, после чего все системные сообщения и страницы административного сайта будут вы­ водиться на этом языке. Если `False`, автоматический перевод выполняться не будет, и сообщения и страницы станут выводиться на английском языке.
- `USE_L10N` - если `True`, числа, значения даты и времени при выводе будут форма­ тироваться по правилам языка, записанного в параметре LANGUAGE_ сооЕ. Если `False`, все эти значенйя будут форматироваться согласно настройкам, заданным в проекте.
- `TIME_ZONE` - обозначение временной зоны в виде строки. Сразу же при создании проекта ему присваивается значение `UTC` (всемирное координи­рованное время).
- `USE_TZ` - если `True`, Django будут хранить значения даты и времени с указанием временной зоны, - в этом случае параметр TIME_ZONE указывает временную зону по умолчанию. Если `False`, значения даты и времени будут храниться без отметки временной зоны.

### 3.4. Создание, настройка и регистрация приложений
Приложения реализуют отдельные части функциональности сайта Django. Любой проект должен содержать, по крайней мере, одно приложение.

### 3.4.1. Создание приложений
- `python manage.py startapp <name_app> [<путь к папке проекта>]` - создание

### 3.4.2. Настройка приложений
- Модуль настроек приложения `apps.py` содержиr объявление конфигурационного класса, описывающего настройки приложения.
	- `name` - полный путь к пакету приложения, записанный относительно папки про­екта, в виде строки. Единственный параметр приложения, обязательный для ука­зания
	- `label` - псевдоним приложения в виде строки. Используется, в том числе, для указания приложения в вызовах утилиты manage.py.
	- `verbose_name` - название приложения, выводимое на страницах административ­ ного сайта Django.
	- `path` - файловый путь к папке пакета приложения.

### 3.4.3. Регистрация приложения в проекте
Чтобы приложение успешно работало, оно должно бьrrь заре­ гистрировано в списке приложений INSTALLED_APPS. Зарегистрировать его можно двумя способами.
	- Добавить в список приложений новый элемент `'bboard.apps.BboardConfig'`
	- В модуле `__iпit_.py__` пакета приложения присвоить путь к конфигурационному классу переменной `default_app_config = 'bboard.apps.BboardConfig'`. После чего добавить в список приложений новый элемент - к пакету приложения:

	INSTALLED APPS = [
		'bboard',
	]

### 3.5. Отладочный веб-сервер Django
Оrладочный веб-сервер Django предназначен для обслуживания сайта в процессе его разработки. Запуск сервера выполняется утилитой `maпage.py` при получении ей команды `runserver`. Эта команда записывается в таком формате:
- `manage.ру runserver [[<интернет-адрес>] [:] [<порт>]] [--noreload] [--nothreading] [--ipv6] [-6]`
По умолчанию отладочный сервер доступен по интернет-адресу http:/Лocalhost: 8000/ и `http:/1127.0.0.1:8000/` (т. е. использует интернет-адрес локального хоста и ТСР-порт № 8000).
- Сайт, написанный на языке `Python` , имеет одну особенность: составляющие его программные модули загружаются при запуске отладочного сервера в оперативную память и, пока сайт работает, постоянно находятся там.
- Оrладочный веб-сервер Django · самостоятельно отслеживает изменения в про­ граммных модулях при их сохранении. И, в случае необходимости, перезапускается самостоятельно.
Команда runserver поддерживает следующие дополнительные ключи:
	- `--noreload` - отключить автоматический перезапуск при изменении программ­ного кода;
	- `--nothreading` - принудительный запуск отладочного сервера в однопоточном режиме (если ключ не указан, сервер запускается в многопоточном режиме);
	- `--ipvб` или `-6` - использовать протокол 1Pv6 вместо 1Pv4. В этом случае по умолчанию будет использоваться интернет-адрес ::1

## ГЛАВА 4 Модели: базовые инструменты

### 4.1. Введение в модели
